# 第七章 数组

<p>除了前面介绍的基本类型(整型、字符型、实型)的数据，C语言还提供了构造类型的数据，他们有数组、结构体类型和共用体类型。构造类型数据由基本类型数据按一定规则祖晨的，因此它们又被称为“导出类型”。</p>
<p>本章介绍数组。数组是有序数据的集合。数组中每一个元素都属于同一个数据类型。用一个统一的数组名和下标来惟一的确定数组中的元素。</p>

## 7.1 一维数组的定义和引用

### 7.1.1 一维数组的定义

<p>一维数组的定义方式：</p>

```c
类型说明符 数组名[常量表达式]
```

<p>如：</p>

```c
int a[10];
```

<p>这表示定义了一个整型数组，数组名为a，有10个元素。</p>
<p>说明：</p>
<p>（1）数组名的命名规则和变量名相同，遵循标识符命名规则。</p>
<p>（2）在定义数组是，需要指定数组中元素的个数，方括号中的常量表达式用来表示元素的个数，即数组长度。例如，指定a[10]，表示a数组有10个元素。注意，下标是从0开始的，这10个元素是：a[0]，a[1]...a[9]。特别注意：按上面的定义，不存在数组元素a[10]。</p>
<p>（3）常量表达式中可以包括常量和符号常量，不能包含变量。也就是说，C语言不允许对数组的大小作动态定义，即数组的大小不依赖于程序运行过程中变量的值。反向举例：</p>

```c
int n;
scanf("%d", &n); // 在程序中临时输入数组大小
int a[n]; // C元不允许这种定义方式
```

### 7.1.2 一维数组元素的引用

<p>数组必须先定义，然后使用。C语言规定只能逐个引用数组元素而不能一次引用整个数组。</p>
<p>数据元素的表示形式为：</p>

```c
数组名[下标];
```

<p>例 7.1 数组元素的引用</p>

```c
#include <stdio.h>

void main()
{
  int i , a[10];
  for(i = 0; i <= 9; i++)
    a[i] = i;
  for(i = 9; i >= 0; i--)
    printf("%d", a[i]);//9 8 7 6 5 4 3 2 1 0
  printf("\n");
}
```

### 7.1.3 一维数组的初始化

<p>对数据元素的初始化可以用以下方法实现。</p>
<p>（1）在定义数组时对数组元素赋予初值。</p>

```c
int a[10] = {0,1,2,3,4,5,6,7,8,9};
```

<p>（2）可以只给一部分元素赋值。</p>

```c
int a[10] = {0,1,2,3,4};
```

<p>定义a数组有10个元素，但花括号内只提供5个初值，这表示只给前面5个元素赋初值，后5个元素值为0。</p>
<p>（3）如果想使一个数组中全部元素值为0，可以写成：</p>

```c
int a[10] = {0,0,0,0,0,0,0,0,0,0};//等价
int a[10] = {0};//等价
int a[10] = {0 * 10};//错误
```

<p>（4）在对全部数组元素赋初值时，由于数据的个数已经确定，因此可以不指定数组长度。</p>

```c
int a[5] = {1,2,3,4,5};//等价
int a[] = {1,2,3,4,5};//等价
```

<p>第二种写法，花括号中有5个数，系统就会据此自动定义a数组的长度为5。但若数组长度与提供初值的个数不相同，则数组长度不能省略。如，想定义数组长度为10，就不能省略数组长度的定义，而必须写成：</p>

```c
int a[10] = {1,2,3,4,5};
```

<p>只初始化前五个元素，后五个元素为0。</p>

### 7.1.4 一维数组程序举例

<p>例 7.2 用数组来处理求 Fibonacci 数列问题。</p>
<p>程序如下：</p>

```c
#include <stdio.h>

void main()
{
  int i;
  int f[20] = {1,1};
  for(i = 2; i < 20; i++)
    f[i]  = f[i-2] + f[i+1];
  for(i = 0; i < 20; i++)
  {
    if(i%5 == 0)printf("\n");
    printf("%12d", f[i]);
  }
  printf("\n");
}
```

<p>运行结果如下：</p>

<table>
<tr align=right>
<td>1</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>5</td>
</tr>
<tr align=right>
<td>8</td>
<td>13</td>
<td>21</td>
<td>34</td>
<td>55</td>
</tr>
<tr align=right>
<td>89</td>
<td>144</td>
<td>233</td>
<td>377</td>
<td>610</td>
</tr>
<tr align=right>
<td>987</td>
<td>1597</td>
<td>2584</td>
<td>4181</td>
<td>6765</td>
</tr>
</table>

<p>例 7.3 用起泡法对10个数排序（由小到大）</p>
<p>起泡法的思路是：将相邻两个数比较，将小的调到前头。</p>

```c
#include <stdio.h>

void main()
{
  int a[10];
  int i,j,t;
  printf("input 10 numbers :\n");
  for(i = 0; i < 10; i++)
    scanf("%d", &a[i]);
  printf("\n");
  for(j = 0; j < 9; j++)
    for(i = 0; i < 9 - j; i++)
    {
      if(a[i] > a[i + 1])
      {
        t = a[i];
        a[i] = a[i + 1];
        a[i + 1] = t;
      }
    }
  printf("the sorted numbers :\n");
  for(i = 0; i < 10; i++)
    printf("%d ", a[i]);
  printf("\n");
}
```

<p>运行情况如下：</p>

```
input 10 numbers :
1 0 4 8 12 65 -76 100 -45 123

the sorted numbers :
-76 -45 0 1 4 8 12 65 100 123
```

## 7.2 二维数组的定义和引用

### 7.2.1 二维数组的定义

<p>二维数组定义的一般形式为：</p>

```c
类型说明符 数组名[常量表达式][常量表达式]
```

<p>C语言对二维数组采用这样的定义方式，使得二维数组可以被看做是一种特殊的一维数组：它的元素又是一个一维数组。例如，可以把a看做是一个一维数组，它有3个元素，a[0]、a[1]、a[2]，每个元素又是一个包含4个元素的一维数组。</p>

<pre>
  / - a[0] --- a[0][0] a[0][1] a[0][2] a[0][3]
  |
a | - a[1] --- a[1][0] a[1][1] a[1][2] a[1][3]
  |
  \ - a[2] --- a[2][0] a[2][1] a[2][2] a[2][3]
</pre>
  
<p>C语言中，二维数组中元素排列的顺序是按行存放的，即在内存中先顺序存放第一行的元素，再存放第二行的元素。</p>
<p>C语言允许使用多维数组。有了二位数组的基础，再掌握多维数组是不困难的。例如，定义三维数组的方法如下：</p>

```c
float a[2][3][4];
```

<p>多维数组元素在内存中的排列顺序：第一位的下标变化最慢，最右边的下标最快。</p>

### 7.2.2 二维数组的引用

<p>二维数组元素的表示形式为：</p>

```c
数组名[下标][下标];
```

<p>数组元素可以出现在表达式中，也可以被赋值，如：</p>

```c
b[1][2] = a[2][3] / 2;
```

<p>在使用数组元素时应注意，下标值应在已定义的数组大小的范围内。</p>
<p>应当严格区分在定义数组时用的a[3][4]和引用元素时的a[3][4]的区别。前者用a[3][4]来定义数组的维数和各维的大小，后者a[3][4]中的3和4是数组元素的下标值，a[3][4]代表行序号为3、列序号为4的元素(行序号和列序号均从0起算)。</p>

### 7.2.3 二维数组的初始化

<p>可以用下面的方法对二维数组初始化：</p>
<p>（1）分行给二维数组赋初值</p>

```c
int a[3][4] = {{1,2,3,4},{5,6,7,8},{9,10,11,12}};
```

<p>（2）将所有数据写在一个花括号内，按数组排列的顺序对各元素赋初值。</p>

```c
int a[3][4] = {1,2,3,4,5,6,7,8,9,10,11,12};
```

<p>效果与方法1相同。但第一种方法更直观</p>
<p>（3）可以对部分元素赋初值。</p>

```c
int a[3][4] = {{1},{5},{9}};
```

<p>作用是只对各行第一列(即序号为0的列)的元素赋初值，其余元素值自动为0。</p>

<pre>
/ 1 0 0 0 \
| 5 0 0 0 |
\ 9 0 0 0 /
</pre>

<p>也可以对各行中的某一元素赋初值，如：</p>

```c
int a[3][4] = {{1},{0,6},{0,0,11}};
```

<pre>
/ 1 0  0 0 \
| 0 6  0 0 |
\ 0 0 11 0 /
</pre>

<p>这种方法对非0元素少时比较方便，不必将所有的0都写出来，只需输入少量数据。也可以只对某几行元素赋初值：</p>

```c
int a[3][4] = {{1},{5,6}};
```

<pre>
/ 1 0 0 0 \
| 5 6 0 0 |
\ 0 0 0 0 /
</pre>

<p>第三行不赋初值，可以对第二行不赋初值，例如：</p>

```c
int a[3][4] = {{1},{},{9}};
```

<p>（4）如果对全部元素都赋初值(即提供全部初始数据)，则定义数组时对第一维度的长度可以不指定，但第二维度的长度不能省。</p>

```c
int a[3][4] = {1,2,3,4,5,6,7,8,9,10,11,12};
```

<p>等价于：</p>

```c
int a[][4] = {1,2,3,4,5,6,7,8,9,10,11,12};
```

<p>系统会根据数据总个数和第二维的长度算出第一维的长度</p>
<p>在定义时也可以只对部分元素赋初值而省略第一维的长度，但应分行赋初值。</p>

```c
int a[3][4] = {{0,0,3},{},{0,10}};
```
<p>这样的写法，能通知编译系统，数组共有三行。数组各元素为：</p>

<pre>
/ 0  0 3 0 \
| 0  0 0 0 |
\ 0 10 0 0 /
</pre>

<p>从本节的介绍中可以看到：C语言在定义数组和表示数组元素时采用a[][]这种两个方括号的方式，对数组初始化时十分有用，它使概念清晰，使用方便，不易出错。</p>

### 7.2.4 二维数组程序举例

<p>例 7.4 将一个二位数组行和列的元素互换，存到另一个二位数组中。例如：</p>

<pre>
a = / 1 2 3 \
    \ 4 5 6 /

b = / 1 4 \
    | 2 5 |
    \ 3 6 /
</pre>

<p>程序如下：</p>

```c
#include <stdio.h>

void main()
{
  int a[2][3] = {{1,2,3},{4,5,6}};
  int b[3][2],i,j;
  printf("array a:\n");
  for(i=0;i<=1;i++)
  {
    for(j=0;j<=2;j++)
    {
      printf("%5d", a[i][j]);
      b[j][i]=a[i][j];
    }
    printf("\n");
  }
  printf("array b:\n");
  for(i=0;i<=2;i++)
  {
    for(j=0;j<=1;j++)
    {
      printf("%5d", a[i][j]);
    }
    printf("\n");
  }
}
```

<p>运行结果如下：</p>

<pre>
array a:
1 2 3
4 5 6
array b:
1 4
2 5
3 6
</pre>

<p>例 7.5 有一个3x4的矩阵，要求编程求出其中值最大的那个元素的值，以及其所在的行号和列号。</p>

```c
#include <stdio.h>

void main()
{
  int i,j,row=0,colum=0,max;
  int a[3][4]={{1,2,3,4},{9,8,7,6},{-10,10,-5,2}};
  max=a[0][0];
  for(i=0;i<=2;i++)
    for(j=0;j<=3;j++)
      if(a[i][j]>max)
      {
        max=a[i][j];
        row=i;
        colum=j;
      }
  printf("max=%d,row=%d,column=%d\n",max,row,colum);
}
```

<p>输出结果为：</p>

<pre>
max=10,row=2,colum=1
</pre>

## 7.3 字符数组

<p>用来存放字符数据的数组就是字符数组。字符数组中的一个元素存放一个字符。</p>

### 7.3.1 字符数组的定义

<p>字符数组的定义方法与前面介绍的类似。例如：</p>

```c
char c[10];
c[0]='I';
c[1]=' ';
c[2]='a';
c[3]='m';
c[4]=' ';
c[5]='h';
c[6]='a';
c[7]='p';
c[8]='p';
c[9]='y';
```

<p>以上定义了c为字符数组，包含十个元素。赋值以后数组的状态如图 7-7所示。</p>

<table>
<tr>
<td>c[0]</td>
<td>c[1]</td>
<td>c[2]</td>
<td>c[3]</td>
<td>c[4]</td>
<td>c[5]</td>
<td>c[6]</td>
<td>c[7]</td>
<td>c[8]</td>
<td>c[9]</td>
</tr>
<tr>
<td>I</td>
<td>_</td>
<td>a</td>
<td>m</td>
<td>_</td>
<td>h</td>
<td>a</td>
<td>p</td>
<td>p</td>
<td>y</td>
</tr>
</table>

* 图 7-7

<p>由于字符型与整型是互相通用的，因此也可以定义一个整型数组，用它存放字符数据，例如：</p>

```c
int c[10];
c[0] = 'a'; /* 合法，但浪费存储空间 */
```

### 7.3.2 字符数组的初始化

<p>对字符数组初始化，最容易理解的方式是逐个字符赋给数组中各元素。例如：</p>

```c
int c[10] = {'I','','a','m','','h','a','p','p','y'};
```

<p>把10个字符分别赋给c[0]~c[9]这10个元素。</p>

___如果在定义字符数组时不进行初始化，则数组中各元素的值是不可预料的。___
___如果花括号中提供的初始值个数(即字符个数)大于数组长度，则按语法错误处理。___
___如果花括号中提供的初始值个数(即字符个数)小于数组长度，则只将这些字符赋给数组中前面那些元素，其余的元素自动定为空字符(即'\0')。___

<p>如：</p>

<table>
<tr>
<td>c[0]</td>
<td>c[1]</td>
<td>c[2]</td>
<td>c[3]</td>
<td>c[4]</td>
<td>c[5]</td>
<td>c[6]</td>
<td>c[7]</td>
<td>c[8]</td>
<td>c[9]</td>
</tr>
<tr>
<td>c</td>
<td>_</td>
<td>p</td>
<td>r</td>
<td>o</td>
<td>g</td>
<td>r</td>
<td>a</td>
<td>m</td>
<td>\0</td>
</tr>
</table>

* 图 7-8

___如果花括号中提供的初始值个数与预定的数组长度相同，在定义时可以省略数组长度，系统会自动根据初值个数确定数组长度。___

<p>例如：</p>

```c
int c[] = {'I','','a','m','','h','a','p','p','y'};
```

<p>数组 c 的长度自动定为10。用这种方式可以不必人工去数字符的个数，尤其在赋初值的字符个数较多时，比较方便。</p>
<p>也可以定义和初始化一个二位字符数组，例如：</p>


```c
char diamond[5][5] = {
  {'','','*'},
  {'','*','','*'},
  {'*','','','','*'},
  {'','*','','*'},
  {'','','*'}
};
```

<p>用它代表一个菱形的平面图形，见图 7-9。完整的程序见例 7.7。</p>

### 7.3.3 字符数组的引用

<p>可以引用字符数组中的一个元素，得到一个字符。</p>
<p>例 7.6 输出一个字符串</p>

```c
#include <stdio.h>

void main()
{
  char c[10] = {'I',' ','a','m',' ','a',' ','b','o','y'};
  int i;
  for(i=0;i<10;i++)
    printf("%c", c[i]);
  printf("\n");
}
```

<p>运行结果：</p>

```c
I am a boy
```

<p>例 7.7 输出一个菱形图。</p>

```c
#include <stdio.h>

void main()
{
  char diamond[][5] = {
    {' ', ' ', '*'},
    {' ', '*', ' ', '*'},
    {'*', ' ', ' ', ' ', '*'},
    {' ', '*', ' ', '*'},
    {' ', ' ', '*'}
  };
  int i,j;
  for(i=0;i<5;i++)
  {
    for(j=0;j<5;j++)
      printf("%c", diamond[i][j]);
    printf("\n");  
  }
}
```

<p>运行结果：</p>

```c
  *
 * *
*   * 
 * *
  *
```

### 7.3.4 字符串和字符串结束标志

<p>在C语言中，是将字符串作为字符数组来处理的。例 7.6 就使用一个一维的字符数组来存放字符串 "I am a boy" 的，字符串中的字符是逐个存放到输在元素中的。这个字符串的实际长度与数组相等。在实际工作中，人们关心的往往是字符串的有效长度而不是字符数组的长度。例如，定义一个字符数组长度为100，而实际有效字符只有40个。为了测定字符串的实际长度，C语言规定了一个“字符串结束标志”，以字符 '\0' 作为标志。如果有一个字符串，前面9个字符都不是空字符(即 '\0')，而第10个字符是 '\0' ，则此字符串的有效字符为 9 个。也就是说，在遇到字符 '\0' 时，表示字符串结束，由它前面的字符组成字符串。</p>
<p>系统对字符串常量也自动加一个 '\0' 作为结束符。例如 "C_Program" 共有9个字符，但在系统中占用10个字节，最后一个字节 '\0' 是由系统自动加上的。字符串作为一维数组存放在内存中。</p>
<p>有了结束标志 '\0' 以后，字符数组的长度久显得不那么重要了。在程序中往往依靠检测 '\0' 的位置来判定字符串是否结束，而不是根据数组的长度来决定字符串的长度。当然，在定义字符数组时应估计实际字符串长度，保证数组长度始终大于字符串实际长度。如果在一个字符数组中先后存放多个不同长度的字符串，则应使数组长度大于最长的字符串的长度。</p>
<p>说明： '\0' 代表ASCII码为0的字符，从ASCII码表中可以查到，ASCII码为0的字符不是一个可以显示的字符，而是一个“空操作符”，即它什么也不做。用它来作为字符串结束标志不会产生附加的操作或增加有效字符，只起一个供辨别的标志。</p>
<p>前面曾用过以下语句输出一个字符串。</p>

```c
  printf("How do you do? \n"); 
```

<p>在执行此语句时系统咋呢么知道应该输出到哪里为止呢？实际上，在内存中存放时，系统自动在最后一个字符 '\n' 的后面追加了一个 '\0' 作为字符串结束标志，在执行 printf 函数时，每输出一个字符检查一次，看下一个字符是否是 '\0' ，遇到就停止输出。</p>
<p>对C语言处理字符串的方法有以上的了解后，再对字符数组初始化的方法补充一种方法，即用字符串常量来使字符数组初始化。例如：</p>

```c
  char c[] = {"I am Happy"}; //字符数组特有的初始化方式。
```

<p>也可以省略花括号，直接写成：</p>

```c
  char c[] = "I am Happy"; //字符数组特有的初始化方式。
```

<p>不像例 7.6 那样用单个字符作为字符数组的初始值，而是用一个字符串(注意字符串的两段是用双撇号而不是单撇号括起来)作为初值。显然，这种方法直观、方便、符合人们的习惯。数组c的长度不是10，而是11，这点请务必注意。因为字符串常量的最后由系统加上一个 '\0'。因此，上面的初始化与下面的初始化等价。</p>

```c
  char c[] = {'I',' ','a','m',' ','h','a','p','p','y','\0'};
```

<p>而不与下面的等价：</p>

```c
  char c[] = {'I',' ','a','m',' ','h','a','p','p','y'};
```

<p>前面的长度为11，后者的长度为10。如果有：</p>

```c
  char c[10] = {"China"};
```

<p>数组c的前5个元素为 'C'、'h'、'i'、'n'、'a'，第六个元素为 '\0'，后4个元素也设定为空字符，见图 7-10。</p>

<table>
<tr>
<td>c[0]</td>
<td>c[1]</td>
<td>c[2]</td>
<td>c[3]</td>
<td>c[4]</td>
<td>c[5]</td>
<td>c[6]</td>
<td>c[7]</td>
<td>c[8]</td>
<td>c[9]</td>
</tr>
<tr>
<td>C</td>
<td>h</td>
<td>i</td>
<td>n</td>
<td>a</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
</tr>
</table>

* 图 7-10

<p>需要说明的是：字符数组并不要求它的最后一个字符为 '\0'，甚至可以不包括 '\0'。像以下这样写完全是合法的：</p>

```c
  char c[5] = {'C','h','i','n','a'};
```

<p>是否需要加 '\0'，完全根据需要决定。但是由于系统对字符串常量自动加一个 '\0'，因此为了使处理方法一致，便于测定字符串的实际长度，以及在程序中做相应的处理，在字符数组也常常人为地加上一个 '\0'，例如：</p>

```c
  char c[6] = {'C','h','i','n','a','\0'};
```

<p>这样做，便于引用字符数组中的字符串。如定义了以下的字符数组：</p>

```c
  char c[] = {"Pascal program"};
```

<p>若想用一个新的字符串代替原有的字符串 "Pascal program"，从键盘向字符数组输入：</p>

<pre>Hello</pre>

<p>如果不加 '\0' 的话，字符数组中的字符如下：</p>

<pre>Hellol program</pre>

<p>新字符串和老字符串连成一片，无法区分开。如果想输出字符数组中的字符串，则会连续输出 Hellol program。现在，系统在 "Hello" 后面加了一个 '\0'，它取代了地留个字符 'l'，它是字符串结束标志，在输出字符数组中的字符串时，遇 '\0' 就停止输出吗，因此只输出了 "Hello" 。从这里可以看到在字符串末尾加 '\0' 的作用。</p>

### 7.3.5 字符数组的输入输出

<p>字符数组的输入输出可以有两种方法。</p>
<p>（1）逐个字符输出。用格式符 "%c" 输入或输出一个字符，如例 7.6。</p>
<p>（2）将整个字符串一次输入或输出。用 "%s" 格式符，意思是对字符串(string)的输入输出。例如：</p>

```c
  char c[] = {"China"};
  printf("%s", c);
```

<p>在内存中数组 c 的状态如图 7-11 所示。输出时，遇结束符 '\0' 就停止输出。结果为：</p>

<pre>China</pre>

<table>
<tr>
<td>c[0]</td>
<td>c[1]</td>
<td>c[2]</td>
<td>c[3]</td>
<td>c[4]</td>
<td>c[5]</td>
</tr>
<tr>
<td>C</td>
<td>h</td>
<td>i</td>
<td>n</td>
<td>a</td>
<td>\0</td>
</tr>
</table>

* 图 7-11

<p>注意：</p>
<p>（1）输出字符不包括结束符 '\0'。</p>
<p>（2）用 "%s" 格式符输出字符串时，printf函数中的输出项是字符数组名，而不是元素名。写成下面这样是不对的：</p>

```c
  char c[] = {"China"};
  printf("%s", c[0]);
```

<p>（3）如果数组长度大于字符串的实际长度，也只输出到遇 '\0' 结束。例如：</p>

```c
  char c[10] = {"China"}; // 字符串长度为5，连 '\0'  共占6个字节。
  printf("%s", c[0]);
```

<p>也只输出字符串的有效字符 "China"，而不是输出10个字符。这就使用字符串结束标志的好处。</p>
<p>（4）如果一个字符数组中包含一个以上 '\0'，则遇到第一个 '\0' 时输出结束。</p>
<p>（5）可以用 scanf 函数输入一个字符串。例如：</p>

```c
  scanf("%s", c);
```

<p>scanf 函数中的输入项 c 是已定义的字符数组名，输入的字符串应短于已定义的字符数组的长度。例如，已定义：</p>

```c
  char c[6];
```

<p>从键盘输入：</p>

<pre>China\n</pre>

<p>系统自动在 China 后面加一个 '\0' 结束符。如果利用一个 scanf 函数输入多个字符串，则在输入时以空格分割。例如：</p>

```c
  char str1[5],str2[5],str3[5];
  scanf("%s%s%s", str1, str2, str3);//未加取地址符，因为数组变量本身就是一个指针，指向数组第一个元素
```

<p>输入数据：</p>

<pre>How are you?\n</pre>

<p>输入后 str1，str2，str3 数组状态如图 7-12。数组中未被赋值的元素的值自动置为 '\0'。</p>

<table>
<tr>
<td></td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>str1</td>
<td>H</td>
<td>o</td>
<td>w</td>
<td>\0</td>
<td>\0</td>
</tr>
<tr>
<td>str2</td>
<td>a</td>
<td>r</td>
<td>e</td>
<td>\0</td>
<td>\0</td>
</tr>
<tr>
<td>str3</td>
<td>y</td>
<td>o</td>
<td>u</td>
<td>?</td>
<td>\0</td>
</tr>
</table>

* 图 7-12

<p>若改为：</p>

```c
  char str[13];
  scanf("%s", str);
```

<p>输入以下12个字符：</p>

<pre>How are you?\n</pre>

<p>由于系统把空格字符作为输入的字符串之间的分隔符，因此只将空格前的字符 "How" 送到 str 中。由于把 "How" 作为一个字符串处理，故在其后加 '\0'。str 数组状态见图 7-13。</p>

<table>
<tr>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr>
<td>H</td>
<td>o</td>
<td>w</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
</tr>
</table>

* 图 7-13

<p>注意：scanf 函数中的输入项如果是字符数组名，不要再加地址符 &，因为在C语言中数组名代表该数组的起始地址。下面写法不正确：</p>

```c
  char str[13];
  scanf("%s", &str);//错误！！！
```

<p>分析图 7-14 所示的字符数组，数组名为 c，占6个字节。数组名 c 代表地址 2000。可以用下面的输出语句得到数组的起始地址。</p>

```c
  printf("%o", c); // 用八进制形式输出数组 c 的起始地址
```

<table>
<tr>
<td></td>
<td>c数组</td>
</tr>
<tr>
<td>2000</td>
<td>C</td>
</tr>
<tr>
<td>2001</td>
<td>h</td>
</tr>
<tr>
<td>2002</td>
<td>i</td>
</tr>
<tr>
<td>2003</td>
<td>n</td>
</tr>
<tr>
<td>2004</td>
<td>a</td>
</tr>
<tr>
<td>2005</td>
<td>\0</td>
</tr>
</table>

* 图 7-14

<p>（6）前面介绍的输出字符串的方法：</p>

```c
  scanf("%s", c);
```

<p>实际上是这样执行的：按字符数组名 c 找到其数组起始地址，然后逐个输出其中的字符，知道遇到 '\0' 为止。</p>

### 7.3.6 字符串处理函数

<p>在C函数库中提供了一些用来处理字符串的函数，使用方便。几乎所有版本的C语言编译系统都提供这些函数。</p>
<p>下面介绍几种常用的函数。</p>

* 1，puts 函数

<p>其一般形式为</p>

```c
  puts(字符数组);
```

<p>其作用是将一个字符串(以'\0'结束的字符序列)输出到终端。举例：</p>

```c
  char str[] = {"China\n Bei jing"};
  puts(str);
```

<p>输出：</p>

<pre>China
Bei jing
</pre>

<p>在输出时将字符结束标志 '\0' 替换为 '\n'，即输出完字符串后换行。</p>

* 2，gets 函数

<p>其一般形式为</p>

```c
  gets(字符数组);
```

<p>其作用是从终端输入一个字符串到字符数组，并且得到一个函数值。该函数值是字符数组的起始地址。如执行下面的函数：</p>

```c
  gets(str);
```
<p>从键盘输入：</p>

<pre>Computer\n</pre>

<p>将输入的字符串 "Computer" 送给字符数组 str(注意，送给数组的共有9个字符，而不是8个)，函数值为字符数组 str 的起始地址。一般利用 gets 函数的目的是向字符数组输入一个字符串，而不大关心其函数值。</p>
<p>注意：puts 和 gets 函数都只能有一个函数参数。</p>

* 3，strcat 函数

<p>其一般形式为</p>

```c
  strcat(字符数组1,字符数组2);
```

<p>strcat是STRing CATenate(字符串连接)的缩写。其作用是连接两个字符数组中的字符串，把字符串2接到字符串1的后面，结果放在字符数组1中，函数调用后得到一个函数值，字符数组1的地址。例如：</p>

```c
  char str1[30] = {"People's Republic of "};
  char str2[] = {"China"};
  printf("%s", strcat(str1, str2));
```

<p>输出：</p>

<pre>People's Republic of China</pre>

<p>连接后的情况见图 7-15：</p>

<table>
<tr>
<td></td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
<td>16</td>
<td>17</td>
<td>18</td>
<td>19</td>
<td>20</td>
<td>21</td>
<td>22</td>
<td>23</td>
<td>24</td>
<td>25</td>
<td>26</td>
<td>27</td>
<td>28</td>
<td>29</td>
</tr>
<tr>
<td>str1：</td>
<td>P</td>
<td>e</td>
<td>o</td>
<td>p</td>
<td>l</td>
<td>e</td>
<td>'</td>
<td>s</td>
<td> </td>
<td>R</td>
<td>e</td>
<td>p</td>
<td>u</td>
<td>b</td>
<td>l</td>
<td>i</td>
<td>c</td>
<td> </td>
<td>o</td>
<td>f</td>
<td> </td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
</tr>
<tr>
<td>str2：</td>
<td>C</td>
<td>h</td>
<td>i</td>
<td>n</td>
<td>a</td>
<td>\0</td>
<td align=center colspan=24>-</td>
</tr>
<tr>
<td>str3：</td>
<td>P</td>
<td>e</td>
<td>o</td>
<td>p</td>
<td>l</td>
<td>e</td>
<td>'</td>
<td>s</td>
<td> </td>
<td>R</td>
<td>e</td>
<td>p</td>
<td>u</td>
<td>b</td>
<td>l</td>
<td>i</td>
<td>c</td>
<td> </td>
<td>o</td>
<td>f</td>
<td> </td>
<td>C</td>
<td>h</td>
<td>i</td>
<td>n</td>
<td>a</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
</tr>
</table>

* 图 7-15

<p>说明</p>
<p>（1）字符数组1必须足够大，以便容纳连接后的新字符串。本利中定义str1的长度为30，是足够大的，如果在定义时改用：</p>

```c
  char str1[] = {"People's Republic of "};
```

<p>就会出问题，因为长度不够。</p>
<p>（2）连接前两个字符串后面都有 '\0'，连接时将字符串1后面的 '\0' 取消，只在新串最后保留 '\0' 。</p>

* 4，strcpy 和 strncpy 函数

<p>其一般形式为：</p>

```c
  strcpy(字符数组1, 字符串2);
```

<p>strcpy是STRingCoPY（字符串复制）的简写。它是字符串复制函数，作用是将字符串2复制到字符数组1中去。例如：</p>

```c
  char str1[10] = '';
  char str2[] = {"China"};
  strcpy(str1, str2);
```

<p>执行后，str1的状态如图 7-16所示。</p>

<table>
<tr>
<td></td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
</tr>
<tr>
<td>str1：</td>
<td>C</td>
<td>h</td>
<td>i</td>
<td>n</td>
<td>a</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
<td>\0</td>
</tr>
</table>

* 图 7-16

<p>说明：</p>
<p>（1）字符数组1必须定义的足够大，以便容纳被复制的字符串。字符数组1的长度不应小于字符串2的长度。</p>
<p>（2）字符数组1必须写成数组名形式（str1），字符串2可以是字符数组名，也可以是一个字符串常量。例如：</p>


```c
  strcpy(str1, "China");
```

<p>作用与前面相同。</p>
<p>（3）如果在复制前未对 str1 数组赋值，则 str1 各字节中的内容是无法预知的，复制时将str2中的字符串和其后的 '\0' 一起复制到是字符数组1中，取代字符数组1中的前面6个字符，最后4个字符并不一定是斜杠零，而是str1中原有的最后四个字节的内容。</p>
<p>（4）不能用赋值语句将一个字符串常量或者字符数组直接给一个字符数组。如下面两行都是不合法的：</p>

```c
  str1 = "China";
  str1 = str2;
```

<p>而只能用strcpy函数将一个字符串复制到另一个字符数组中去。用估值语句只能将一个字符赋给一个字符型变量或字符数组元素。如下面的语句是合法的：</p>

```c
  char a[5],c1,c2;
  c1 = 'A'; 
  c2 = 'B';
  a[0] = 'C';
  a[0] = 'h';
  a[0] = 'i';
  a[0] = 'n';
  a[0] = 'a';
```

<p>（5）可以用 strncpy 函数将字符串 2 中前面 n 个字符复制到字符数组1 中去。例如：</p>

```c
  strncpy(str1, str2, 2);
```

<p>作用是将 str2 中最前面 2 各字复制到 str1 中，取代 str1 中原有的最前面 2 个字符。但复制的字符个数 n 不应多于 str1 中原有的字符(不包括 '\0')。</p>

* 5，strcmp 函数

<p>其一般形式为</p>


```c
  strcmp(字符串1, 字符串2);
```

<p>strcmp 是 STRing CoMPare （字符串比较）的缩写。它的作用是比较字符串1和字符串2。例如：</p>

```c
  strcmp(str1, str2);
  strcmp("China", "Korea");
  strcmp(str1, "Bei jing");
```

<p>字符串比较的规则与其他语言中的规则相同，即对两个字符串自左至右逐个字符数相比(按ASCII码值大小比较)，直到出现不同的字符或遇到 '\0' 为止。如全部字符相同，则认为相等；若出现不相同的字符，则以第一个不相同的字符的比较结果为准。</p>
<p>注意：</p>

```c
  if(str1, str2) // 这种比较方式是错误的
    printf("yes");
```

* 6，strlen 函数

<p>其一般形式为：</p>

```c
  strlen(字符数组);
```

<p>strlen 是 STRingLENgth（字符串长度）的缩写。它是测试字符串长度的函数。函数的值为字符串中的实际长度（不包括 '\0' 在内）。例如：</p>

```c
  char str[10] = {"China"};
  printf("%d", strlen(str));//注意：输出结果不是10，也不是6，而是5
```

* 7，strlwr 函数

<p>其一般形式为：</p>

```c
  strlwr(字符串);
```

<p>strlwr 是 STRing LoWeRcase （字符串小写）的缩写。寒素的作用是将字符串中大写字母换成小写字母。</p>

* 8，strupr 函数

<p>其一般形式为：</p>

```c
  strupr(字符串);
```

<p>strupr 是 STRing UPpeRcase （字符串大写）的缩写。寒素的作用是将字符串中小写字母换成大写字母。</p>

<p>以上介绍了常用的8种字符串处理函数，应当再次强调：库函数并非C语言本身的组成部分，而是C语言编译系统为方便用户使用而提供的公共函数。不同的编译系统提供的函数数量和函数名、函数功能都不尽相同，使用时要小心，必要时查一下库函数手册。当然，有一些基本的函数（包括函数名和函数功能），不同的系统所提供的是相同的，这就为程序的通用性提供了基础。</p>

### 7.3.7 字符数组应用举例

<p>例 7.8 输入一行字符，统计其中有多少个单词，单词之间用空格分隔开。</p>
<p>程序如下：</p>

```c
#include <stdio.h>

void main()
{
  char string[81];
  int i, num = 0,word = 0;
  char c;
  gets(string);
  for(i=0; (c=string[i]) != '\0'; i++)
  {
    if(c == ' '){
      word = 0;
    } else if (word==0){
      word = 1;
      num++;
    }
  }
  printf("There are %d words in the line.\n", num);
}
```

<p>运行情况如下：</p>

<pre>I am a boy.
There are 4 words in the line.
</pre>

<p>例 7-9 有三个字符串，要求找出其中最大者。</p>

```c
#include <stdio.h>
#include <string.h>

void main()
{
  char string[20];
  char str[3][20];
  int i;
  for(i=0;i<3;i++)
    gets(str[i]);
  if(strcmp(str[0], str[1])>0)
    strcpy(string, str[0]);
  else
    strcpy(string, str[1]);
  if(strcmp(str[2], string)>0)
    strcpy(string, str[2]);
  printf("\nthe largest string is:\n%s\n", string);
}
```

<p>运行结果如下：</p>

<pre>CHINA\n
HOLLAND\n
AMERICA\n

the largest string is:
HOLLAND
</pre>
